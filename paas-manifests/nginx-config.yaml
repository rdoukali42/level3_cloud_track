apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-config
  namespace: default
data:
  default.conf: |
    server {
        listen 80;
        server_name _;

        location = / {
            add_header Content-Type text/plain;
            return 200 'Hello from PaaS(PostgresSql) API!';
        }

        location = /api/v1/databases {
            default_type application/json;
            add_header Content-Type application/json;
            if ($request_method = POST) {
                return 201 '{"id": "test-db", "name": "test-db", "status": "created"}';
            }
            return 200 '[{"id": "demo-db", "name": "demo-database", "status": "running"}]';
        }

        location ~ ^/api/v1/databases/[^/]+$ {
            default_type application/json;
            add_header Content-Type application/json;
            if ($request_method = DELETE) {
                return 200 '{"result": "deleted"}';
            }
            return 200 '{"id": "demo-db", "name": "demo-database", "status": "running"}';
        }

        location ~ ^/api/v1/databases/[^/]+/metrics$ {
            default_type application/json;
            add_header Content-Type application/json;
            return 200 '{"cpu_usage": "0.25 cores", "memory_usage": "256Mi", "storage_usage": "1Gi"}';
        }
    }